{# todos/templates/todos/partials/todo_item.html #}
<div id="todo-{{ todo.id }}" class="card mb-2">
  <div class="card-body d-flex justify-content-between gap-3">
    <div class="flex-grow-1">
      <div class="d-flex align-items-center gap-2">
        {% if todo.is_completed %}
          <span class="badge text-bg-success">Completed</span>
        {% else %}
          <span class="badge text-bg-warning">Pending</span>
        {% endif %}

        <h6 class="mb-0">{{ todo.title }}</h6>
      </div>

      {% if todo.description %}
        <p class="text-muted mb-1">{{ todo.description|truncatechars:140 }}</p>
      {% endif %}

      {% if todo.due_date %}
        <small class="text-muted">Due: {{ todo.due_date }}</small>
      {% endif %}
    </div>

    <div class="d-flex align-items-start gap-2">
      {# Toggle complete (HTMX-enhanced form) #}
      <form
        method="post"
        action="{% url 'todos:toggle' todo.id %}"
        hx-post="{% url 'todos:toggle' todo.id %}"
        hx-target="#todo-{{ todo.id }}"
        hx-swap="outerHTML"
      >
        {% csrf_token %}
        {% if todo.is_completed %}
          <button class="btn btn-outline-secondary btn-sm" type="submit">Uncomplete</button>
        {% else %}
          <button class="btn btn-outline-success btn-sm" type="submit">Complete</button>
        {% endif %}
      </form>

      <a class="btn btn-outline-primary btn-sm" href="{% url 'todos:edit' todo.id %}">Edit</a>

      {# Delete (HTMX-enhanced form) #}
      <form
        method="post"
        action="{% url 'todos:delete' todo.id %}"
        hx-post="{% url 'todos:delete' todo.id %}"
        hx-target="#todo-{{ todo.id }}"
        hx-swap="outerHTML"
        hx-confirm="Delete this todo?"
      >
        {% csrf_token %}
        <button class="btn btn-outline-danger btn-sm" type="submit">Delete</button>
      </form>
    </div>
  </div>
</div>

<!-- Out-of-band message container
<div id="messages" hx-swap-oob="true">
  {% include "core/partials/messages.html" %}
</div>
-->
